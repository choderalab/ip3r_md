# ip3r_md

This project is focused on preparing and simulating a minimal models of the human type 2 inositol trisphosphate receptor (hIP3R2) containing the juxtamembrane domain (JD), a portion of armadillo repeat 3 (ARM3), and a portion of the S6 helix with or without various bound nucleotides. 

# IP3R

IP3R is an endoplasmic reticulum (ER) resident calcium (Ca2+) channel which plays a central role in intracellular Ca2+ signaling. IP3R is activated by binding of inositol trisphosphate (IP3) and low Ca2+ concentrations, and is inhibited by high Ca2+ concentrations. IP3R activity is potentiated modulated by adenine-containing molecules, but the precise structural mechanism of potentiation has not been well described. The purpose of this project is to use molecular dynamics (MD) simulations to predict impact of adenine-nucleotide binding on the structure of the hIP3R2 domain that binds the adenine nucleotides. 

The general simulation and analysis scheme for this project is as follows. A reduced monomeric portion of hIP3R2 in the resting state containing the JD, a portion of ARM3, and a portion of the S6 helix having either an adenine nucleotide bound or in a ligand-free state was placed in a water box with neutralizing ions using CHARMMGUI (https://charmm-gui.org/). The system was simulated using OpenMM version 7.7.0 (https://openmm.org/). using the CHARMM36m forcefield (https://academiccharmm.org/showcase/natmeth_2016_14_71). 

The impact of ATP binding on JD stability was measured by finding the absolute difference in RMSF of the ATP bound system from the ligand-free system. Based on the RMSF analysis, the euclidean distance between the centers of mass of the backbone atoms of helices α103 and α108 was chosen as a collective variable (CV) for tracking the effect of various nucleotides on JD dynamics. 


# Simulation system setup

1. Models of hIP3R2 in the resting state with ATP-bound (`/ip3r_md/1starting_models/ATP/resting_ATP_refined_protomer.pdb`), cAMP-bound (`/ip3r_md/1starting_models/cAMP/resting_cAMP_refined_protomer.pdb`), or in ligand-free (`/ip3r_md/1starting_models/ligand-free/resting_apo_refined_protomer.pdb`) were built from maps determined using single-particle cryogenic electron microscopy (cryo-EM). The starting simulation constructs were generated from residues 1909 to 2216 and 2549 to 2636 plus Zn2+ and bound ligands from these models. The resulting models are `/ip3r_md/2model_preparation/ATP/ip3r2_jd_atp.pdb` (ATP-bound), `/ip3r_md/2model_preparation/cAMP/ip3r2_jd_cAMP.pdb` (cAMP-bound), and `/ip3r_md/2model_preparation/ligand-free/ip3r2_jd_apo.pdb` (apo-bound). ADP-, AMP-, adenosine-, and guanosine-bound models were generated by editing the ATP molecule in the ATP-bound model in Coot (https://www2.mrc-lmb.cam.ac.uk/personal/pemsley/coot/) to ADP (`/ip3r_md/2model_preparation/ADP/ip3r2_jd_adp.pdb`), AMP (`/ip3r_md/2model_preparation/AMP/ip3r2_jd_admp.pdb`), adenosine (`/ip3r_md/2model_preparation/adenosine/ip3r2_jd_adenosine.pdb`), or guanosine (`/ip3r_md/2model_preparation/guanosine/ip3r2_jd_guanosine.pdb`).

2. Models in `/ip3r_md/2model_preparation` were used as inputs to CHARMMGUI (https://www.charmm-gui.org/) Solution Builder. ATP-bound models with mutations were generated using CHARMMGUI Solution Builder. Models were solvated in a water box with 416 mM NaCl.

# Running and analyzing simulations

### Equilibration

Prior to producing simulations that are used in analyses, the simulation systems produced by CHARMMGUI (the topology for each system being `step3_input.pdb` in each individual system directory in `/ip3r_md/3equilibration/`) should be energy minimized and equilibrated. Instructions for initiating minimization and equilibration generated by CHARMMGUI can be found in each system directory in `/ip3r_md/3equilibration/`.

### Production

The equilibrated system can be further equilibrated and simulated for production with scripts located in `/ip3r_md/4production/`. Instructions for initiating these simulations can be found within `/4production/`.

### Analysis

Simulation trajectories can be analyzed with jupyter notebooks located in `/ip3r_md/5analysis`. All of the notebooks in this directory are associated with figures in "Structural dynamics of adenine nucleotide potentiation of the human type 2 IP3 receptor"

# Directory structure

* `/1starting_models` contains PDB files of atomic models of monomeric hIP3R2 in the resting state with ATP-bound, cAMP-bound, or in a ligand-free state determined via cryo-EM.
* `/2model_preparation` contains PDB files that are of monomeric hIP3R2 with only residues 1909 to 2216 and 2549 to 2636 plus Zn2+ and bound ligands.
* `/3equilibration` contains outputs from CHARMGUI Solution Builder and files required to energy minimize and equilibrate systems using OpenMM.
* `/4production` contains scripts that can be used to simulate systems using OpenMM.
* `/5analysis` contains scripts that can be used to reproduce analyses done on simulation trajectories and to make figures for "Structural dynamics of adenine nucleotide potentiation of the human type 2 IP3 receptor".


